public void testMultipleIDGeneration() throws Exception {
    ZKUUIDService uuid1 = new ZKUUIDService();
    ZKUUIDService uuid2 = new ZKUUIDService();
    try {
        setSystemProperty(UUIDService.CONF_GENERATOR, "counter");
        uuid1.init(Services.get());
        uuid2.init(Services.get());
        for (int i = 0; i < 1000; i += 2) {
            String id1 = uuid1.generateId(ApplicationType.WORKFLOW);
            String id2 = uuid2.generateId(ApplicationType.WORKFLOW);
            assertEquals(Integer.parseInt(id1.substring(0, 7)), i);
            assertEquals(Integer.parseInt(id2.substring(0, 7)), i + 1);
        }
    } finally {
        uuid1.destroy();
        uuid2.destroy();
    }
}
