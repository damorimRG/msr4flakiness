@Test
public void testStrings() {
    for (int i = 1; i < 150000; i += 10000) {
        String value = RandomStringUtils.random(i);
        try {
            ByteArrayOutputStream baos = new ByteArrayOutputStream();
            DataOutput dataOutput = new DataOutputStream(baos);
            StringSerializationUtil.writeString(dataOutput, value);
            DataInput dataInput = new DataInputStream(new ByteArrayInputStream(baos.toByteArray()));
            assertEquals("Error in serialization for size " + i, value, StringSerializationUtil.readString(dataInput));
        } catch (IOException e) {
            e.printStackTrace();
            fail("Error in serialization for size " + i + "\n" + value);
        }
    }
}
