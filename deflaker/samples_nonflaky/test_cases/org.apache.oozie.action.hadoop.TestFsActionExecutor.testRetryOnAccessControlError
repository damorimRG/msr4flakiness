public void testRetryOnAccessControlError() throws Exception {
    FsActionExecutor ae = new FsActionExecutor();
    FileSystem fs = getFileSystem();
    Path path = new Path(getFsTestCaseDir(), "dir");
    fs.mkdirs(path);
    fs.setPermission(path, FsPermission.valueOf("-rwx------"));
    // do FS operation using different user to cause permission error
    Context context = createContextWithUser("<fs/>", getTestUser2());
    try {
        ae.chmod(context, path, "-r--------", false, false);
        fail();
    } catch (Exception e) {
        assertTrue(e instanceof ActionExecutorException);
        assertEquals("FS014", ((ActionExecutorException) e).getErrorCode());
        assertEquals(ActionExecutorException.ErrorType.ERROR, ((ActionExecutorException) e).getErrorType());
    }
}
