@Test
public void testReadWrite() throws Exception {
    String definition = "test" + RandomStringUtils.random(100 * 1024);
    LiteWorkflowApp app = new LiteWorkflowApp("name", definition, new StartNodeDef(LiteWorkflowStoreService.LiteControlNodeHandler.class, "foo"));
    app.addNode(new EndNodeDef("foo", LiteWorkflowStoreService.LiteControlNodeHandler.class));
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    DataOutputStream out = new DataOutputStream(baos);
    app.write(out);
    ByteArrayInputStream bais = new ByteArrayInputStream(baos.toByteArray());
    DataInputStream in = new DataInputStream(bais);
    LiteWorkflowApp app2 = new LiteWorkflowApp();
    app2.readFields(in);
    assertTrue(app.equals(app2));
}
