public void testJobXmlWithOozieLauncher() throws Exception {
    String str = "<java>" + "<job-xml>job.xml</job-xml>" + "<configuration>" + "<property><name>oozie.launcher.p2</name><value>v2b</value></property>" + "<property><name>p4</name><value>v4</value></property>" + "</configuration>" + "</java>";
    Element xml = XmlUtils.parseXml(str);
    Path appPath = new Path(getFsTestCaseDir(), "app");
    getFileSystem().mkdirs(appPath);
    XConfiguration jConf = new XConfiguration();
    jConf.set("oozie.launcher.p1", "v1");
    jConf.set("oozie.launcher.p2", "v2a");
    jConf.set("p3", "v3");
    OutputStream os = getFileSystem().create(new Path(appPath, "job.xml"));
    jConf.writeXml(os);
    os.close();
    Configuration conf = new XConfiguration();
    assertEquals(0, conf.size());
    JavaActionExecutor jae = new JavaActionExecutor("java");
    jae.setupLauncherConf(conf, xml, appPath, createContext("<java/>", null));
    assertEquals(4, conf.size());
    assertEquals("v1", conf.get("oozie.launcher.p1"));
    assertEquals("v1", conf.get("p1"));
    assertEquals("v2b", conf.get("oozie.launcher.p2"));
    assertEquals("v2b", conf.get("p2"));
}
