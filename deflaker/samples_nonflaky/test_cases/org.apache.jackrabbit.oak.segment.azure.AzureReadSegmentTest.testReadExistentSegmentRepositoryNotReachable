@Test(expected = RepositoryNotReachableException.class)
public void testReadExistentSegmentRepositoryNotReachable() throws URISyntaxException, IOException, InvalidFileStoreVersionException, StorageException {
    AzurePersistence p = new ReadFailingAzurePersistence(container.getDirectoryReference("oak"));
    FileStore fs = FileStoreBuilder.fileStoreBuilder(new File("target")).withCustomPersistence(p).build();
    SegmentId id = new SegmentId(fs, 0, 0);
    byte[] buffer = new byte[2];
    try {
        fs.writeSegment(id, buffer, 0, 2);
        fs.readSegment(id);
    } finally {
        fs.close();
    }
}
