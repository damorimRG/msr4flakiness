public void testAdminPurgeCommandNegative() throws Exception {
    runTest(END_POINTS, SERVLET_CLASSES, IS_SECURITY_ENABLED, new Callable<Void>() {

        @Override
        public Void call() throws Exception {
            String oozieUrl = getContextURL();
            String[] args = new String[] { "admin", "-purge", "-oozie", oozieUrl };
            String error = runOozieCLIAndGetStderr(args);
            assertTrue(error.contains("Missing argument for option: purge"));
            args = new String[] { "admin", "-purge", "invalid=1", "-oozie", oozieUrl };
            error = runOozieCLIAndGetStderr(args);
            assertTrue(error.contains("INVALID_INPUT : Invalid purge option [invalid] specified."));
            args = new String[] { "admin", "-purge", "wf=1;coord=", "-oozie", oozieUrl };
            error = runOozieCLIAndGetStderr(args);
            assertTrue(error.contains("INVALID_INPUT : Invalid purge option pair [coord=] specified."));
            args = new String[] { "admin", "-purge", "wf=1;coord=-1", "-oozie", oozieUrl };
            error = runOozieCLIAndGetStderr(args);
            assertTrue(error.contains("Input value should be a positive integer. Value: -1"));
            args = new String[] { "admin", "-purge", "wf=a", "-oozie", oozieUrl };
            error = runOozieCLIAndGetStderr(args);
            assertTrue(error.contains("For input string: \"a\""));
            return null;
        }
    });
}
