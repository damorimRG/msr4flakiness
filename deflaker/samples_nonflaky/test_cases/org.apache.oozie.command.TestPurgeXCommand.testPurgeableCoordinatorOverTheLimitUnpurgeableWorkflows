/**
 * Test : The workflows should not get purged, but the coordinator parent should get purged --> none will get purged
 * There are more workflow children than the limit
 *
 * @throws Exception if cannot insert records to the database
 */
public void testPurgeableCoordinatorOverTheLimitUnpurgeableWorkflows() throws Exception {
    CoordinatorJobBean coordJob = addRecordToCoordJobTable(CoordinatorJob.Status.SUCCEEDED, false, false);
    WorkflowJobBean[] wfJobs = new WorkflowJobBean[TEST_CHILD_NUM];
    WorkflowActionBean[] wfActions = new WorkflowActionBean[TEST_CHILD_NUM];
    CoordinatorActionBean[] coordActions = new CoordinatorActionBean[TEST_CHILD_NUM];
    for (int i = 0; i < TEST_CHILD_NUM; ++i) {
        wfJobs[i] = addRecordToWfJobTable(WorkflowJob.Status.SUCCEEDED, WorkflowInstance.Status.SUCCEEDED);
        wfActions[i] = addRecordToWfActionTable(wfJobs[i].getId(), "1", WorkflowAction.Status.OK);
        coordActions[i] = addRecordToCoordActionTable(coordJob.getId(), i, CoordinatorAction.Status.SUCCEEDED, "coord-action-get.xml", wfJobs[i].getId(), "SUCCEEDED", 0);
    }
    purgeWithSpecialParameters(LIMIT_3_ITEMS, wfJobs[0]);
    assertCoordinatorJobNotPurged(coordJob);
    assertCoordinatorActionsNotPurged(coordActions);
    assertWorkflowJobsNotPurged(wfJobs);
    assertWorkflowActionsNotPurged(wfActions);
}
