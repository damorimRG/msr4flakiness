@Test
public void testActionDataUploadToHdfsSucceeds() throws Exception {
    hdfsOperations.uploadActionDataToHDFS(configurationMock, path, actionData);
    verify(seqFileWriterFactoryMock).createSequenceFileWriter(eq(configurationMock), any(Path.class), eq(Text.class), eq(Text.class));
    ArgumentCaptor<Text> keyCaptor = ArgumentCaptor.forClass(Text.class);
    ArgumentCaptor<Text> valueCaptor = ArgumentCaptor.forClass(Text.class);
    verify(writerMock).append(keyCaptor.capture(), valueCaptor.capture());
    assertEquals("testKey", keyCaptor.getValue().toString());
    assertEquals("testValue", valueCaptor.getValue().toString());
}
