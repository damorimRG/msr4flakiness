public void testGetUpdateQuery() throws Exception {
    EntityManager em = jpaService.getEntityManager();
    CoordinatorJobBean cjBean = addRecordToCoordJobTable(CoordinatorJob.Status.PREP, true, true);
    // UPDATE_COORD_JOB
    Query query = CoordJobQueryExecutor.getInstance().getUpdateQuery(CoordJobQuery.UPDATE_COORD_JOB, cjBean, em);
    assertEquals(query.getParameterValue("appName"), cjBean.getAppName());
    assertEquals(query.getParameterValue("appPath"), cjBean.getAppPath());
    assertEquals(query.getParameterValue("concurrency"), cjBean.getConcurrency());
    assertEquals(query.getParameterValue("conf"), cjBean.getConfBlob());
    assertEquals(query.getParameterValue("externalId"), cjBean.getExternalId());
    assertEquals(query.getParameterValue("frequency"), cjBean.getFrequency());
    assertEquals(query.getParameterValue("lastActionNumber"), cjBean.getLastActionNumber());
    assertEquals(query.getParameterValue("timeOut"), cjBean.getTimeout());
    assertEquals(query.getParameterValue("timeZone"), cjBean.getTimeZone());
    assertEquals(query.getParameterValue("createdTime"), cjBean.getCreatedTimestamp());
    assertEquals(query.getParameterValue("endTime"), cjBean.getEndTimestamp());
    assertEquals(query.getParameterValue("execution"), cjBean.getExecution());
    assertEquals(query.getParameterValue("jobXml"), cjBean.getJobXmlBlob());
    assertEquals(query.getParameterValue("lastAction"), cjBean.getLastActionTimestamp());
    assertEquals(query.getParameterValue("lastModifiedTime"), cjBean.getLastModifiedTimestamp());
    assertEquals(query.getParameterValue("nextMaterializedTime"), cjBean.getNextMaterializedTimestamp());
    assertEquals(query.getParameterValue("origJobXml"), cjBean.getOrigJobXmlBlob());
    assertEquals(query.getParameterValue("slaXml"), cjBean.getSlaXmlBlob());
    assertEquals(query.getParameterValue("startTime"), cjBean.getStartTimestamp());
    assertEquals(query.getParameterValue("status"), cjBean.getStatus().toString());
    assertEquals(query.getParameterValue("timeUnit"), cjBean.getTimeUnit().toString());
    assertEquals(query.getParameterValue("appNamespace"), cjBean.getAppNamespace());
    assertEquals(query.getParameterValue("bundleId"), cjBean.getBundleId());
    assertEquals(query.getParameterValue("id"), cjBean.getId());
    // UPDATE_COORD_JOB_STATUS
    query = CoordJobQueryExecutor.getInstance().getUpdateQuery(CoordJobQuery.UPDATE_COORD_JOB_STATUS, cjBean, em);
    assertEquals(query.getParameterValue("status"), cjBean.getStatus().toString());
    assertEquals(query.getParameterValue("id"), cjBean.getId());
    // UPDATE_COORD_JOB_BUNDLEID
    cjBean.setBundleId("bundleID-test");
    query = CoordJobQueryExecutor.getInstance().getUpdateQuery(CoordJobQuery.UPDATE_COORD_JOB_BUNDLEID, cjBean, em);
    assertEquals(query.getParameterValue("bundleId"), cjBean.getBundleId());
    assertEquals(query.getParameterValue("id"), cjBean.getId());
    // UPDATE_COORD_JOB_STATUS_PENDING
    query = CoordJobQueryExecutor.getInstance().getUpdateQuery(CoordJobQuery.UPDATE_COORD_JOB_STATUS_PENDING, cjBean, em);
    assertEquals(query.getParameterValue("status"), cjBean.getStatus().toString());
    assertEquals(query.getParameterValue("pending"), cjBean.isPending() ? 1 : 0);
    assertEquals(query.getParameterValue("id"), cjBean.getId());
    // UPDATE_COORD_JOB_STATUS_MODTIME
    query = CoordJobQueryExecutor.getInstance().getUpdateQuery(CoordJobQuery.UPDATE_COORD_JOB_STATUS_MODTIME, cjBean, em);
    assertEquals(query.getParameterValue("status"), cjBean.getStatus().toString());
    assertEquals(query.getParameterValue("lastModifiedTime"), cjBean.getLastModifiedTimestamp());
    assertEquals(query.getParameterValue("id"), cjBean.getId());
    // UPDATE_COORD_JOB_STATUS_PENDING_MODTIME
    query = CoordJobQueryExecutor.getInstance().getUpdateQuery(CoordJobQuery.UPDATE_COORD_JOB_STATUS_PENDING_MODTIME, cjBean, em);
    assertEquals(query.getParameterValue("status"), cjBean.getStatus().toString());
    assertEquals(query.getParameterValue("lastModifiedTime"), cjBean.getLastModifiedTimestamp());
    assertEquals(query.getParameterValue("pending"), cjBean.isPending() ? 1 : 0);
    assertEquals(query.getParameterValue("id"), cjBean.getId());
    // UPDATE_COORD_JOB_LAST_MODIFIED_TIME
    query = CoordJobQueryExecutor.getInstance().getUpdateQuery(CoordJobQuery.UPDATE_COORD_JOB_LAST_MODIFIED_TIME, cjBean, em);
    assertEquals(query.getParameterValue("lastModifiedTime"), cjBean.getLastModifiedTimestamp());
    assertEquals(query.getParameterValue("id"), cjBean.getId());
    // UPDATE_COORD_JOB_STATUS_PENDING_TIME
    query = CoordJobQueryExecutor.getInstance().getUpdateQuery(CoordJobQuery.UPDATE_COORD_JOB_STATUS_PENDING_TIME, cjBean, em);
    assertEquals(query.getParameterValue("status"), cjBean.getStatus().toString());
    assertEquals(query.getParameterValue("lastModifiedTime"), cjBean.getLastModifiedTimestamp());
    assertEquals(query.getParameterValue("doneMaterialization"), cjBean.isDoneMaterialization() ? 1 : 0);
    assertEquals(query.getParameterValue("suspendedTime"), cjBean.getSuspendedTimestamp());
    assertEquals(query.getParameterValue("lastModifiedTime"), cjBean.getLastModifiedTimestamp());
    assertEquals(query.getParameterValue("id"), cjBean.getId());
    // UPDATE_COORD_JOB_MATERIALIZE
    query = CoordJobQueryExecutor.getInstance().getUpdateQuery(CoordJobQuery.UPDATE_COORD_JOB_MATERIALIZE, cjBean, em);
    assertEquals(query.getParameterValue("status"), cjBean.getStatus().toString());
    assertEquals(query.getParameterValue("pending"), cjBean.isPending() ? 1 : 0);
    assertEquals(query.getParameterValue("doneMaterialization"), cjBean.isDoneMaterialization() ? 1 : 0);
    assertEquals(query.getParameterValue("lastActionTime"), cjBean.getLastActionTimestamp());
    assertEquals(query.getParameterValue("lastActionNumber"), cjBean.getLastActionNumber());
    assertEquals(query.getParameterValue("nextMatdTime"), cjBean.getNextMaterializedTimestamp());
    assertEquals(query.getParameterValue("id"), cjBean.getId());
    // UPDATE_COORD_JOB_CHANGE
    query = CoordJobQueryExecutor.getInstance().getUpdateQuery(CoordJobQuery.UPDATE_COORD_JOB_CHANGE, cjBean, em);
    assertEquals(query.getParameterValue("endTime"), cjBean.getEndTimestamp());
    assertEquals(query.getParameterValue("status"), cjBean.getStatus().toString());
    assertEquals(query.getParameterValue("pending"), cjBean.isPending() ? 1 : 0);
    assertEquals(query.getParameterValue("doneMaterialization"), cjBean.isDoneMaterialization() ? 1 : 0);
    assertEquals(query.getParameterValue("concurrency"), cjBean.getConcurrency());
    assertEquals(query.getParameterValue("pauseTime"), cjBean.getPauseTimestamp());
    assertEquals(query.getParameterValue("lastActionNumber"), cjBean.getLastActionNumber());
    assertEquals(query.getParameterValue("lastActionTime"), cjBean.getLastActionTimestamp());
    assertEquals(query.getParameterValue("nextMatdTime"), cjBean.getNextMaterializedTimestamp());
    assertEquals(query.getParameterValue("lastModifiedTime"), cjBean.getLastModifiedTimestamp());
    assertEquals(query.getParameterValue("id"), cjBean.getId());
    em.close();
}
