/**
 * Test : The subworkflow should get purged, and the workflow parent should get purged --> both will get purged
 * Subworkflow has terminated, last modified time is known, but end time is null
 *
 * @throws Exception if cannot insert records to the database
 */
public void testPurgeableWorkflowPurgeableSubWorkflowWithNullEndTimeValidLastModifiedTime() throws Exception {
    WorkflowJobBean wfJob = addRecordToWfJobTable(WorkflowJob.Status.SUCCEEDED, WorkflowInstance.Status.SUCCEEDED);
    WorkflowActionBean wfAction1 = addRecordToWfActionTable(wfJob.getId(), "1", WorkflowAction.Status.OK);
    WorkflowJobBean subwfJob1 = addRecordToWfJobTable(WorkflowJob.Status.SUCCEEDED, WorkflowInstance.Status.SUCCEEDED, wfJob.getId());
    subwfJob1.setLastModifiedTime(wfJob.getEndTime());
    subwfJob1.setEndTime(null);
    final QueryExecutor<WorkflowJobBean, WorkflowJobQueryExecutor.WorkflowJobQuery> workflowJobQueryExecutor = WorkflowJobQueryExecutor.getInstance();
    workflowJobQueryExecutor.executeUpdate(WorkflowJobQuery.UPDATE_WORKFLOW, subwfJob1);
    purgeWithSpecialParameters(LIMIT_3_ITEMS);
    assertWorkflowJobPurged(wfJob);
    assertWorkflowActionPurged(wfAction1);
    assertWorkflowJobPurged(subwfJob1);
}
