@Test(expected = ConstraintViolationException.class)
public void testPasswordValidationActionOnChange() throws Exception {
    User user = getUserManager(root).createUser("testuser", "testPw123456");
    String hashed = PasswordUtil.buildPasswordHash("abc");
    try {
        pwAction.init(getSecurityProvider(), ConfigurationParameters.of(PasswordValidationAction.CONSTRAINT, "abc"));
        user.changePassword(hashed);
    } finally {
        verify(testAction, times(1)).onCreate(user, "testPw123456", root, getNamePathMapper());
        verify(testAction, never()).onPasswordChange(user, hashed, root, getNamePathMapper());
    }
}
