/**
 * Test : purge killed bundle job and action successfully
 *
 * @throws Exception if cannot insert records to the database
 */
public void testKilledBundle() throws Exception {
    BundleJobBean job = addRecordToBundleJobTable(Job.Status.KILLED, DateUtils.parseDateOozieTZ("2011-01-01T01:00Z"));
    CoordinatorJobBean coordJob1 = addRecordToCoordJobTable(CoordinatorJob.Status.KILLED, false, false);
    coordJob1.setAppName("action1");
    CoordinatorJobBean coordJob2 = addRecordToCoordJobTable(CoordinatorJob.Status.KILLED, false, false);
    coordJob2.setAppName("action2");
    BundleActionBean bundleAction1 = addRecordToBundleActionTable(job.getId(), "action1", 0, Job.Status.KILLED);
    BundleActionBean bundleAction2 = addRecordToBundleActionTable(job.getId(), "action2", 0, Job.Status.KILLED);
    purgeWithDefaultParameters();
    assertBundleJobPurged(job);
    assertBundleActionPurged(bundleAction1);
    assertBundleActionPurged(bundleAction2);
    assertCoordinatorJobPurged(coordJob1);
    assertCoordinatorJobPurged(coordJob2);
}
