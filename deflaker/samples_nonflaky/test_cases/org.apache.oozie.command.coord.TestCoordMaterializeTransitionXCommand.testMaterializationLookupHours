public void testMaterializationLookupHours() throws Exception {
    Date startTime = DateUtils.parseDateOozieTZ("2009-02-01T01:00Z");
    Date endTime = DateUtils.parseDateOozieTZ("2009-05-03T23:59Z");
    CoordinatorJobBean job = addRecordToCoordJobTable(CoordinatorJob.Status.PREP, startTime, endTime, false, false, 0);
    job.setNextMaterializedTime(startTime);
    job.setMatThrottling(10);
    job.setFrequency("1");
    job.setTimeUnitStr("HOUR");
    CoordJobQueryExecutor.getInstance().executeUpdate(CoordJobQuery.UPDATE_COORD_JOB, job);
    new CoordMaterializeTransitionXCommand(job.getId(), hoursToSeconds(1)).call();
    job = jpaService.execute(new CoordJobGetJPAExecutor(job.getId()));
    assertEquals(new Date(startTime.getTime() + TIME_IN_HOURS * 10), job.getNextMaterializedTime());
}
