/**
 * Test HCat tableIn and tableOut EL functions (phase 3) which returns the HCat table from
 * URI
 *
 * @throws Exception
 */
@Test
public void testTable() throws Exception {
    init("coord-action-start", "hcat://hcat.server.com:5080/mydb/clicks/datastamp=12;region=us");
    eval.setVariable(".datain.ABC", "hcat://hcat.server.com:5080/mydb/clicks/datastamp=12;region=us");
    eval.setVariable(".datain.ABC.unresolved", Boolean.FALSE);
    String expr = "${coord:tableIn('ABC')}";
    assertEquals("clicks", CoordELFunctions.evalAndWrap(eval, expr));
    eval.setVariable(".dataout.ABC", "hcat://hcat.server.com:5080/mydb/clicks/datastamp=12;region=us");
    eval.setVariable(".dataout.ABC.unresolved", Boolean.FALSE);
    expr = "${coord:tableOut('ABC')}";
    assertEquals("clicks", CoordELFunctions.evalAndWrap(eval, expr));
    init("coord-action-start", "hcat://hcat.server.com:5080/mydb/clicks");
    eval.setVariable(".datain.ABC", "hcat://hcat.server.com:5080/mydb/clicks");
    eval.setVariable(".datain.ABC.unresolved", Boolean.FALSE);
    expr = "${coord:tableIn('ABC')}";
    assertEquals("clicks", CoordELFunctions.evalAndWrap(eval, expr));
    eval.setVariable(".dataout.ABC", "hcat://hcat.server.com:5080/mydb/clicks");
    eval.setVariable(".dataout.ABC.unresolved", Boolean.FALSE);
    expr = "${coord:tableOut('ABC')}";
    assertEquals("clicks", CoordELFunctions.evalAndWrap(eval, expr));
    init("coord-sla-create", "hcat://hcat.server.com:5080/mydb/clicks/datastamp=12;region=us");
    eval.setVariable(".dataout.ABC", "hcat://hcat.server.com:5080/mydb/clicks/datastamp=12;region=us");
    eval.setVariable(".dataout.ABC.unresolved", Boolean.FALSE);
    expr = "${coord:tableOut('ABC')}";
    assertEquals("clicks", CoordELFunctions.evalAndWrap(eval, expr));
}
