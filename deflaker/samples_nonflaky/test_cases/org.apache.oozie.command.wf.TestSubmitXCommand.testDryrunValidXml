public void testDryrunValidXml() throws Exception {
    Configuration conf = new XConfiguration();
    String workflowUri = getTestCaseFileUri("workflow.xml");
    String appXml = IOUtils.getResourceAsString("wf-schema-valid-global.xml", -1);
    writeToFile(appXml, workflowUri);
    conf.set(OozieClient.APP_PATH, workflowUri);
    conf.set(OozieClient.USER_NAME, getTestUser());
    SubmitXCommand sc = new SubmitXCommand(true, conf);
    try {
        sc.call();
        fail("Should fail with variable cannot be resolved");
    } catch (CommandException ex) {
        assertEquals(ErrorCode.E0803, ex.getErrorCode());
        assertEquals("E0803: IO error, variable [foo] cannot be resolved", ex.getMessage());
    }
    conf.set("foo", "foo");
    sc = new SubmitXCommand(true, conf);
    assertEquals("OK", sc.call());
}
