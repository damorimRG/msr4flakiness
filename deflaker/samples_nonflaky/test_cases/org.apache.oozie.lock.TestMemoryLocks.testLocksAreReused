public void testLocksAreReused() throws ServiceException, InterruptedException {
    String path = "a";
    MemoryLocksService lockService = new MemoryLocksService();
    lockService.init(Services.get());
    LockToken lock = lockService.getWriteLock(path, DEFAULT_LOCK_TIMEOUT);
    int oldHash = System.identityHashCode(lockService.getMemoryLocks().getLockMap().get(path));
    System.gc();
    lock.release();
    lock = lockService.getWriteLock(path, DEFAULT_LOCK_TIMEOUT);
    assertEquals(lockService.getMemoryLocks().size(), 1);
    int newHash = System.identityHashCode(lockService.getMemoryLocks().getLockMap().get(path));
    assertTrue(oldHash == newHash);
}
