@Test
public void testDrainBuffersImmediatelyEndingProcess() throws Exception {
    checkSampleStringWithDifferentMaxLength(new StringAndIntProcessingCallback() {

        public void call(String sampleString, int suggestedMaxLength) throws IOException {
            checkDrainBuffers(1, sampleString, "", suggestedMaxLength);
            checkDrainBuffers(1, "", sampleString.toLowerCase(), suggestedMaxLength);
            checkDrainBuffers(1, sampleString, sampleString.toLowerCase(), suggestedMaxLength);
        }
    });
}
