@Test
public void testDrainBuffersLongPause() throws Exception {
    checkSampleStringWithDifferentMaxLength(new StringAndIntProcessingCallback() {

        public void call(String sampleString, int suggestedMaxLength) throws IOException, InterruptedException {
            // only run some of the tests because of the speed limit
            boolean runThisTest = sampleString.length() == 0 || sampleString.length() < 1024 * 1024 && suggestedMaxLength > 1024;
            if (runThisTest) {
                checkDrainBuffersLongPause(sampleString, "", suggestedMaxLength);
                checkDrainBuffersLongPause("", sampleString.toLowerCase(), suggestedMaxLength);
                checkDrainBuffersLongPause(sampleString, sampleString.toLowerCase(), suggestedMaxLength);
            }
        }
    });
}
