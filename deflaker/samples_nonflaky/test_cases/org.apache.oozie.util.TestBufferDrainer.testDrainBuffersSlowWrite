@Test
public void testDrainBuffersSlowWrite() throws Exception {
    checkSampleStringWithDifferentMaxLength(new StringAndIntProcessingCallback() {

        public void call(String sampleString, int suggestedMaxLength) throws IOException, InterruptedException {
            checkDrainBufferSlow(sampleString, "", suggestedMaxLength);
            checkDrainBufferSlow("", sampleString.toLowerCase(), suggestedMaxLength);
            checkDrainBufferSlow(sampleString, sampleString.toLowerCase(), suggestedMaxLength);
        }
    });
}
