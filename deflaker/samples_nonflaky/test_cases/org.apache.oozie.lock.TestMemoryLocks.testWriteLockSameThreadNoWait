public void testWriteLockSameThreadNoWait() throws Exception {
    StringBuffer sb = new StringBuffer("");
    SameThreadWriteLocker l1 = new SameThreadWriteLocker("a", 1, 0, sb);
    Locker l2 = new WriteLocker("a", 2, 0, sb);
    new Thread(l1).start();
    l1.awaitLockAcquire();
    new Thread(l2).start();
    l1.awaitStart();
    l2.proceed();
    l2.awaitTermination();
    l1.proceed();
    l1.awaitTermination();
    assertEquals("a:1-L1 a:1-L2 a:1-U1 a:2-N a:1-U2", sb.toString().trim());
}
