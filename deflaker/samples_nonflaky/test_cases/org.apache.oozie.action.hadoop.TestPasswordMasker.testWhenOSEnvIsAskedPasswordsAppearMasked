@Test
public void testWhenOSEnvIsAskedPasswordsAppearMasked() throws Exception {
    Map<String, String> masked = passwordMasker.mask(jsonToMap("/instrumentation-os-env.json"));
    assertPasswordValueIsMasked(masked, "HADOOP_CREDSTORE_PASSWORD");
    assertPasswordValueIsMasked(masked, "OOZIE_HTTPS_KEYSTORE_PASSWORD");
    assertPasswordValueIsMasked(masked, "OOZIE_HTTPS_TRUSTSTORE_PASSWORD");
    assertPasswordValueFragmentIsMasked(masked, "CATALINA_OPTS", "-Doozie.https.keystore.pass=");
    assertPasswordValueFragmentIsMasked(masked, "CATALINA_OPTS", "-Djavax.net.ssl.trustStorePassword=");
    assertValueFragmentIsPresent(masked, "CATALINA_OPTS", "-Xmx1024m");
    assertValueFragmentIsPresent(masked, "CATALINA_OPTS", "-Doozie.https.keystore.file=/Users/forsage/.keystore");
    assertValueFragmentIsPresent(masked, "CATALINA_OPTS", "-Djava.library.path=");
}
