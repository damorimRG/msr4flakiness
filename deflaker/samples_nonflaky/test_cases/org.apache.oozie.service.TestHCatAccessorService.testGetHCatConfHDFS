@Test
public void testGetHCatConfHDFS() throws Exception {
    Path hcatConfPath = new Path(getFsTestCaseDir(), "hive-site.xml");
    assertFalse(getFileSystem().exists(hcatConfPath));
    assertNull(services.get(HCatAccessorService.class).getHCatConf());
    Configuration hcatConf = new Configuration(false);
    hcatConf.set("A", "a");
    FSDataOutputStream out = getFileSystem().create(hcatConfPath);
    hcatConf.writeXml(out);
    out.close();
    assertTrue(getFileSystem().exists(hcatConfPath));
    services.destroy();
    services = super.setupServicesForHCatalog();
    Configuration conf = services.getConf();
    conf.set("oozie.service.HCatAccessorService.hcat.configuration", hcatConfPath.toUri().toString());
    services.init();
    Configuration hcatConfLoaded = services.get(HCatAccessorService.class).getHCatConf();
    assertEquals("a", hcatConfLoaded.get("A"));
}
