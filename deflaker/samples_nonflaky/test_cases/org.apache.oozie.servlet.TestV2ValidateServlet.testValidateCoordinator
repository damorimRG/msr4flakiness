public void testValidateCoordinator() throws Exception {
    runTest("/v2/validate", V2ValidateServlet.class, IS_SECURITY_ENABLED, new Callable<Void>() {

        public Void call() throws Exception {
            Map<String, String> params = new HashMap<String, String>();
            params.put("file", "coordinator.xml");
            params.put("user", getTestUser());
            URL url = createURL("", params);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setRequestMethod("POST");
            conn.setRequestProperty("content-type", RestConstants.XML_CONTENT_TYPE);
            conn.setDoOutput(true);
            String xml = "<coordinator-app name=\"coord-simple\" frequency=\"${coord:minutes(1)}\"\n" + "                 start=\"${startTime}\" end=\"${endTime}\"\n" + "                 timezone=\"Asia/Seoul\"\n" + "                 xmlns=\"uri:oozie:coordinator:0.1\">\n" + "    <action>\n" + "        <workflow>\n" + "            <app-path>${nameNode}/user/seoeun/workflow-ndap/apps/v40/shell-outstream</app-path>\n" + "        </workflow>\n" + "    </action>\n" + "</coordinator-app>";
            writeXML(conn.getOutputStream(), xml);
            assertEquals(HttpServletResponse.SC_OK, conn.getResponseCode());
            JSONObject obj = (JSONObject) JSONValue.parse(new InputStreamReader(conn.getInputStream(), StandardCharsets.UTF_8));
            assertEquals("Valid workflow-app", obj.get(JsonTags.VALIDATE));
            return null;
        }
    });
}
