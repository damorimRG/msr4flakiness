@Test
public void testGetPrimaryTypeNameNotAccessibleNew() throws Exception {
    Tree testTree = TreeUtil.addChild(root.getTree("/"), "test", NodeTypeConstants.NT_OAK_UNSTRUCTURED);
    Tree t = Mockito.mock(Tree.class);
    when(t.hasProperty(JcrConstants.JCR_PRIMARYTYPE)).thenReturn(false);
    when(t.getStatus()).thenReturn(Tree.Status.NEW);
    assertNull(TreeUtil.getPrimaryTypeName(t, new LazyValue<Tree>() {

        @Override
        protected Tree createValue() {
            return testTree;
        }
    }));
}
