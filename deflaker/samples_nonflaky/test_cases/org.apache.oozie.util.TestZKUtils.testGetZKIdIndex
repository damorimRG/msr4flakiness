public void testGetZKIdIndex() throws Exception {
    DummyUser du = new DummyUser();
    DummyZKOozie dummyOozie = null;
    DummyZKOozie dummyOozie2 = null;
    try {
        dummyOozie = new DummyZKOozie("a", "http://blah");
        du.register();
        assertEquals(1, du.getZKUtils().getZKIdIndex(du.getZKUtils().getAllMetaData()));
        dummyOozie2 = new DummyZKOozie("b", "http://blah");
        assertEquals(1, du.getZKUtils().getZKIdIndex(du.getZKUtils().getAllMetaData()));
        dummyOozie.teardown();
        assertEquals(0, du.getZKUtils().getZKIdIndex(du.getZKUtils().getAllMetaData()));
    } finally {
        du.unregister();
        if (dummyOozie != null) {
            dummyOozie.teardown();
        }
        if (dummyOozie2 != null) {
            dummyOozie2.teardown();
        }
    }
}
