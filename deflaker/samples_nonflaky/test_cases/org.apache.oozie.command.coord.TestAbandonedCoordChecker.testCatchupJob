public void testCatchupJob() throws Exception {
    Date start = DateUtils.addMonths(new Date(), -1);
    // 4 hrs
    Date end = DateUtils.addHours(new Date(), 4);
    Date createdTime = DateUtils.addDays(new Date(), -1);
    CoordinatorJobBean job1 = addRecordToCoordJobTable(CoordinatorJob.Status.RUNNING, start, end, createdTime, true, false, 6);
    addRecordToCoordActionTable(job1.getId(), 6, CoordinatorAction.Status.FAILED);
    createdTime = DateUtils.addDays(new Date(), -3);
    CoordinatorJobBean job2 = addRecordToCoordJobTable(CoordinatorJob.Status.RUNNING, start, end, createdTime, true, false, 4);
    addRecordToCoordActionTable(job2.getId(), 10, CoordinatorAction.Status.FAILED);
    new AbandonedCoordCheckerRunnable(5, true).run();
    // Only one job should be running.
    assertEquals(CoordJobQueryExecutor.getInstance().get(CoordJobQuery.GET_COORD_JOB, job1.getId()).getStatus(), CoordinatorJob.Status.RUNNING);
    assertEquals(CoordJobQueryExecutor.getInstance().get(CoordJobQuery.GET_COORD_JOB, job2.getId()).getStatus(), CoordinatorJob.Status.KILLED);
}
