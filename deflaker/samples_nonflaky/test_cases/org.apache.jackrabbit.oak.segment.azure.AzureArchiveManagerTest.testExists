@Test
public void testExists() throws IOException, URISyntaxException {
    SegmentArchiveManager manager = new AzurePersistence(container.getDirectoryReference("oak")).createArchiveManager(false, false, new IOMonitorAdapter(), new FileStoreMonitorAdapter(), new RemoteStoreMonitorAdapter());
    SegmentArchiveWriter writer = manager.create("data00000a.tar");
    List<UUID> uuids = new ArrayList<>();
    for (int i = 0; i < 10; i++) {
        UUID u = UUID.randomUUID();
        writer.writeSegment(u.getMostSignificantBits(), u.getLeastSignificantBits(), new byte[10], 0, 10, 0, 0, false);
        uuids.add(u);
    }
    writer.flush();
    writer.close();
    Assert.assertTrue(manager.exists("data00000a.tar"));
    Assert.assertFalse(manager.exists("data00001a.tar"));
}
