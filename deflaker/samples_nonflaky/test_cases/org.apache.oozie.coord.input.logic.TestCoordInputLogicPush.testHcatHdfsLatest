public void testHcatHdfsLatest() throws Exception {
    Configuration conf = getConfForCombine();
    Date now = new Date();
    conf.set("start_time", DateUtils.formatDateOozieTZ(now));
    conf.set("end_time", DateUtils.formatDateOozieTZ(new Date(now.getTime() + 10 * TIME_DAYS)));
    conf.set("initial_instance_a", DateUtils.formatDateOozieTZ(new Date(now.getTime() - 5 * TIME_DAYS)));
    conf.set("initial_instance_b", DateUtils.formatDateOozieTZ(new Date(now.getTime() - 5 * TIME_DAYS)));
    conf.set("initial_instance", DateUtils.formatDateOozieTZ(new Date(now.getTime() - 5 * TIME_DAYS)));
    SimpleDateFormat sd = new SimpleDateFormat("yyyy/MM/dd");
    TimeZone tzUTC = TimeZone.getTimeZone("UTC");
    sd.setTimeZone(tzUTC);
    String inputLogic = // @formatter:off
    "<and name=\"test\" min = \"1\" >" + "<data-in dataset=\"A\" />" + "<data-in dataset=\"D\" />" + "</and>";
    // @formatter:on
    String jobId = submitCoord("coord-inputlogic-combine.xml", conf, inputLogic, TEST_TYPE.LATEST_RANGE);
    String input1 = createTestCaseSubDir(("input-data/d/" + sd.format(now) + "/_SUCCESS").split("/"));
    sd = new SimpleDateFormat("yyyyMMdd");
    String input2 = addPartition("db_a", "table1", "dt=" + sd.format(now) + ";country=usa");
    startCoordAction(jobId);
    CoordinatorActionBean actionBean = CoordActionQueryExecutor.getInstance().get(CoordActionQuery.GET_COORD_ACTION, jobId + "@1");
    assertFalse(CoordinatorAction.Status.WAITING.equals(actionBean.getStatus()));
    XConfiguration runConf = new XConfiguration(new StringReader(actionBean.getRunConf()));
    String dataSets = runConf.get("inputLogicData");
    assertEquals(dataSets.split(",").length, 2);
    checkDataSets(dataSets, input1, input2);
}
