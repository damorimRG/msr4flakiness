public void testValidateRerunConfigurationTrueRerunFailNodesNonEmptySkipNodes() {
    String appPath = getTestCaseDir();
    boolean rerunFailNodes = true;
    String rerunSkipNodes = "node1";
    Configuration rerunConfig = setupRerunConfig(appPath, rerunFailNodes, rerunSkipNodes);
    try {
        engine.validateReRunConfiguration(rerunConfig);
        fail("DagEngineException should have been thrown");
    } catch (DagEngineException e) {
        assertEquals("Missing expected error code", ErrorCode.E0404, e.getErrorCode());
        assertTrue("Missing expected error message", e.getMessage().contains(OozieClient.RERUN_FAIL_NODES));
        assertTrue("Missing expected error message", e.getMessage().contains(OozieClient.RERUN_SKIP_NODES));
    }
}
