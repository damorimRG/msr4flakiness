public void testSubmitWithSLAAlertsDisable() throws Exception {
    Configuration conf = new XConfiguration();
    File appPathFile = new File(getTestCaseDir(), "coordinator.xml");
    // CASE 1: Failure case i.e. multiple data-in instances
    Reader reader = IOUtils.getResourceAsReader("coord-action-sla.xml", -1);
    Writer writer = new OutputStreamWriter(new FileOutputStream(appPathFile), StandardCharsets.UTF_8);
    IOUtils.copyCharStream(reader, writer);
    conf.set(OozieClient.COORDINATOR_APP_PATH, appPathFile.toURI().toString());
    conf.set("start", DateUtils.formatDateOozieTZ(new Date()));
    conf.set("end", DateUtils.formatDateOozieTZ(org.apache.commons.lang3.time.DateUtils.addMonths(new Date(), 1)));
    conf.set("frequency", "coord:days(1)");
    conf.set(OozieClient.USER_NAME, getTestUser());
    reader = IOUtils.getResourceAsReader("wf-credentials.xml", -1);
    appPathFile = new File(getTestCaseDir(), "workflow.xml");
    writer = new OutputStreamWriter(new FileOutputStream(appPathFile), StandardCharsets.UTF_8);
    IOUtils.copyCharStream(reader, writer);
    conf.set("wfAppPath", appPathFile.getPath());
    Date nominalTime = new Date();
    conf.set("nominal_time", DateUtils.formatDateOozieTZ(nominalTime));
    String coordId = new CoordSubmitXCommand(conf).call();
    new CoordMaterializeTransitionXCommand(coordId, 3600).call();
    SLAService slaService = services.get(SLAService.class);
    SLACalculator calc = slaService.getSLACalculator();
    SLACalcStatus slaCalc = calc.get(coordId + "@" + 1);
    assertFalse(Boolean.valueOf(slaCalc.getSLAConfigMap().get(OozieClient.SLA_DISABLE_ALERT)));
    Configuration conf1 = new Configuration(conf);
    // CASE I: "ALL"
    conf1.set(OozieClient.SLA_DISABLE_ALERT, "ALL");
    coordId = new CoordSubmitXCommand(conf1).call();
    new CoordMaterializeTransitionXCommand(coordId, 3600).call();
    slaService = services.get(SLAService.class);
    calc = slaService.getSLACalculator();
    slaCalc = calc.get(coordId + "@" + 1);
    assertTrue(Boolean.valueOf(slaCalc.getSLAConfigMap().get(OozieClient.SLA_DISABLE_ALERT)));
    // CASE II: Date Range
    Configuration conf2 = new Configuration(conf);
    Date startRangeDate = new Date(nominalTime.getTime() - 3600 * 1000);
    conf2.set(OozieClient.SLA_DISABLE_ALERT, DateUtils.formatDateOozieTZ(startRangeDate) + "::" + DateUtils.formatDateOozieTZ(nominalTime));
    coordId = new CoordSubmitXCommand(conf2).call();
    new CoordMaterializeTransitionXCommand(coordId, 3600).call();
    slaCalc = calc.get(coordId + "@" + 1);
    assertTrue(Boolean.valueOf(slaCalc.getSLAConfigMap().get(OozieClient.SLA_DISABLE_ALERT)));
    // CASE III: Coord name (negative test)
    Configuration conf3 = new Configuration(conf);
    conf3.set(OozieClient.SLA_DISABLE_ALERT_COORD, "test-coord-sla-x");
    coordId = new CoordSubmitXCommand(conf3).call();
    new CoordMaterializeTransitionXCommand(coordId, 3600).call();
    slaCalc = calc.get(coordId + "@" + 1);
    assertFalse(Boolean.valueOf(slaCalc.getSLAConfigMap().get(OozieClient.SLA_DISABLE_ALERT)));
    // CASE IV: Older than n(hours)
    Date otherNominalTime = new Date(nominalTime.getTime() - 73 * 3600 * 1000);
    conf = new XConfiguration();
    appPathFile = new File(getTestCaseDir(), "coordinator.xml");
    conf.set(OozieClient.COORDINATOR_APP_PATH, appPathFile.toURI().toString());
    conf.set("wfAppPath", appPathFile.getPath());
    conf.set("start", DateUtils.formatDateOozieTZ(org.apache.commons.lang3.time.DateUtils.addMonths(new Date(), -1)));
    conf.set("end", DateUtils.formatDateOozieTZ(org.apache.commons.lang3.time.DateUtils.addMonths(new Date(), 1)));
    conf.set(OozieClient.USER_NAME, getTestUser());
    conf.set("nominal_time", DateUtils.formatDateOozieTZ(otherNominalTime));
    conf.setInt(OozieClient.SLA_DISABLE_ALERT_OLDER_THAN, 72);
    coordId = new CoordSubmitXCommand(conf).call();
    new CoordMaterializeTransitionXCommand(coordId, 3600).call();
    slaCalc = calc.get(coordId + "@" + 1);
    assertTrue(Boolean.valueOf(slaCalc.getSLAConfigMap().get(OozieClient.SLA_DISABLE_ALERT)));
    // catchup mode
    conf = new XConfiguration();
    conf.set(OozieClient.COORDINATOR_APP_PATH, appPathFile.toURI().toString());
    conf.set("wfAppPath", appPathFile.getPath());
    conf.set("start", DateUtils.formatDateOozieTZ(org.apache.commons.lang3.time.DateUtils.addMonths(new Date(), -1)));
    conf.set("end", DateUtils.formatDateOozieTZ(org.apache.commons.lang3.time.DateUtils.addMonths(new Date(), 1)));
    conf.set(OozieClient.USER_NAME, getTestUser());
    conf.set("nominal_time", DateUtils.formatDateOozieTZ(org.apache.commons.lang3.time.DateUtils.addMonths(new Date(), -1)));
    conf.set(OozieClient.USER_NAME, getTestUser());
    conf.set("nominal_time", DateUtils.formatDateOozieTZ(org.apache.commons.lang3.time.DateUtils.addMonths(new Date(), -1)));
    coordId = new CoordSubmitXCommand(conf).call();
    new CoordMaterializeTransitionXCommand(coordId, 3600).call();
    slaCalc = calc.get(coordId + "@" + 1);
    assertTrue(Boolean.valueOf(slaCalc.getSLAConfigMap().get(OozieClient.SLA_DISABLE_ALERT)));
    // normal mode
    conf = new XConfiguration();
    conf.set(OozieClient.COORDINATOR_APP_PATH, appPathFile.toURI().toString());
    conf.set("wfAppPath", appPathFile.getPath());
    conf.set("start", DateUtils.formatDateOozieTZ(new Date()));
    conf.set("end", DateUtils.formatDateOozieTZ(org.apache.commons.lang3.time.DateUtils.addMonths(new Date(), 1)));
    conf.set(OozieClient.USER_NAME, getTestUser());
    conf.set("nominal_time", DateUtils.formatDateOozieTZ(new Date()));
    conf.set(OozieClient.USER_NAME, getTestUser());
    conf.set("nominal_time", DateUtils.formatDateOozieTZ(new Date()));
    coordId = new CoordSubmitXCommand(conf).call();
    new CoordMaterializeTransitionXCommand(coordId, 3600).call();
    slaCalc = calc.get(coordId + "@" + 1);
    assertFalse(Boolean.valueOf(slaCalc.getSLAConfigMap().get(OozieClient.SLA_DISABLE_ALERT)));
}
