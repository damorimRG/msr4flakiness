/**
 * Test HCat dataInPartition EL function (phase 1) which echo back the EL
 * function itself
 *
 * @throws Exception
 */
@Test
public void testDataInPartitionsPh1() throws Exception {
    init("coord-job-submit-data");
    String expr = "${coord:dataInPartitions('ABC', 'hive-export')}";
    // +ve test
    eval.setVariable("oozie.dataname.ABC", "data-in");
    assertEquals("${coord:dataInPartitions('ABC', 'hive-export')}", CoordELFunctions.evalAndWrap(eval, expr));
    // -ve test
    expr = "${coord:dataInPartitions('ABCD', 'hive-export')}";
    try {
        CoordELFunctions.evalAndWrap(eval, expr);
        fail("should throw exception because Data-in is not defined");
    } catch (Exception ex) {
    }
    // -ve test
    expr = "${coord:dataInPartitions('ABCD')}";
    eval.setVariable("oozie.dataname.ABCD", "data-in");
    try {
        CoordELFunctions.evalAndWrap(eval, expr);
        fail("should throw exception because EL function requires 2 parameters");
    } catch (Exception ex) {
    }
}
