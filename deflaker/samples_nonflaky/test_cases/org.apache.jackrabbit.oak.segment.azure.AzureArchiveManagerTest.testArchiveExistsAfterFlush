@Test
public void testArchiveExistsAfterFlush() throws URISyntaxException, IOException {
    SegmentArchiveManager manager = new AzurePersistence(container.getDirectoryReference("oak")).createArchiveManager(false, false, new IOMonitorAdapter(), new FileStoreMonitorAdapter(), new RemoteStoreMonitorAdapter());
    SegmentArchiveWriter writer = manager.create("data00000a.tar");
    Assert.assertFalse(manager.exists("data00000a.tar"));
    UUID u = UUID.randomUUID();
    writer.writeSegment(u.getMostSignificantBits(), u.getLeastSignificantBits(), new byte[10], 0, 10, 0, 0, false);
    writer.flush();
    Assert.assertTrue(manager.exists("data00000a.tar"));
}
