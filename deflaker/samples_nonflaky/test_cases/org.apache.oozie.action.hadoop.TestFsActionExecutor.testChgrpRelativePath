public void testChgrpRelativePath() throws Exception {
    String testUser = getTestUser();
    String testGroup = getTestGroup();
    String testGroup2 = getTestGroup2();
    FsActionExecutor ae = new FsActionExecutor();
    FileSystem fs = getFileSystem();
    Context context = createContext("<fs/>");
    Path basePath = new Path(getFsTestCaseDir(), "2010");
    createTestDirForChgrp(basePath, fs);
    Path globPath = new Path(basePath + "/1[0-1]");
    Path relativePath = new Path(globPath.toUri().getPath());
    Path nameNode = new Path(globPath.toUri().getScheme() + "://" + globPath.toUri().getAuthority());
    ae.chgrp(context, null, nameNode, relativePath, testUser, testGroup2, false, false);
    assertEquals(testGroup2, fs.getFileStatus(new Path(basePath, "10")).getGroup().toString());
    assertEquals(testGroup2, fs.getFileStatus(new Path(basePath, "11")).getGroup().toString());
    assertEquals(testGroup, fs.getFileStatus(new Path(basePath, "12")).getGroup().toString());
    assertEquals(testGroup, fs.getFileStatus(new Path(basePath + "/10/dir1")).getGroup().toString());
    assertEquals(testGroup, fs.getFileStatus(new Path(basePath + "/10/dir2")).getGroup().toString());
    assertEquals(testGroup, fs.getFileStatus(new Path(basePath + "/11/dir3")).getGroup().toString());
    assertEquals(testGroup, fs.getFileStatus(new Path(basePath + "/10/dir1/file1")).getGroup().toString());
    try {
        ae.chgrp(context, null, null, relativePath, testUser, testGroup2, false, false);
        fail();
    } catch (ActionExecutorException e) {
        assertEquals(e.getErrorCode(), "FS001");
    }
    fs.delete(basePath, true);
}
