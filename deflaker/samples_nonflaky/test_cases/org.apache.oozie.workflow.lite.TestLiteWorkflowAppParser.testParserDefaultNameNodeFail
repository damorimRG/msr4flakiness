public void testParserDefaultNameNodeFail() throws Exception {
    LiteWorkflowAppParser parser = newLiteWorkflowAppParser();
    // No default NN is set
    try {
        parser.validateAndParse(IOUtils.getResourceAsReader("wf-schema-no-namenode.xml", -1), new Configuration());
        fail();
    } catch (WorkflowException e) {
        assertEquals(ErrorCode.E0701, e.getErrorCode());
        assertTrue(e.getMessage().contains("No name-node defined"));
    }
}
