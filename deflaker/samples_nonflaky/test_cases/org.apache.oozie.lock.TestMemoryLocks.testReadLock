public void testReadLock() throws Exception {
    StringBuffer sb = new StringBuffer("");
    Locker l1 = new ReadLocker("a", 1, -1, sb);
    Locker l2 = new ReadLocker("a", 2, -1, sb);
    new Thread(l1).start();
    // L1 is holding a readlock
    l1.awaitLockAcquire();
    new Thread(l2).start();
    // both L1 & L2 are holding a readlock
    l2.awaitLockAcquire();
    l1.proceed();
    l1.awaitTermination();
    l2.proceed();
    l2.awaitTermination();
    assertEquals("a:1-L a:2-L a:1-U a:2-U", sb.toString().trim());
}
