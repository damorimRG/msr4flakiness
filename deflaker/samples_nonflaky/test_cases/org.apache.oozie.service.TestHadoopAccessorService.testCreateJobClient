public void testCreateJobClient() throws Exception {
    HadoopAccessorService has = Services.get().get(HadoopAccessorService.class);
    Configuration conf = has.createConfiguration(getJobTrackerUri());
    JobClient jc = has.createJobClient(getTestUser(), conf);
    assertNotNull(jc);
    jc.getAllJobs();
    JobConf conf2 = new JobConf(false);
    conf2.set("mapred.job.tracker", getJobTrackerUri());
    try {
        has.createJobClient(getTestUser(), conf2);
        fail("Should have thrown exception because Configuration not created by HadoopAccessorService");
    } catch (HadoopAccessorException ex) {
        assertEquals(ErrorCode.E0903, ex.getErrorCode());
    }
}
