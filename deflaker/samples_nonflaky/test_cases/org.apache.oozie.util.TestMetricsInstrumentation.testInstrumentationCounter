public void testInstrumentationCounter() throws Exception {
    MetricsInstrumentation inst = new MetricsInstrumentation();
    assertEquals(0, inst.getMetricRegistry().getCounters().size());
    inst.incr("a", "1", 1);
    assertEquals(1, inst.getMetricRegistry().getCounters().size());
    inst.incr("a", "2", 2);
    assertEquals(2, inst.getMetricRegistry().getCounters().size());
    inst.incr("b", "1", 3);
    assertEquals(3, inst.getMetricRegistry().getCounters().size());
    assertEquals(1L, inst.getMetricRegistry().getCounters().get("a.1").getCount());
    assertEquals(2L, inst.getMetricRegistry().getCounters().get("a.2").getCount());
    assertEquals(3L, inst.getMetricRegistry().getCounters().get("b.1").getCount());
    assertEquals(1L, inst.getCounters().get("a").get("1").getValue().longValue());
    assertEquals(2L, inst.getCounters().get("a").get("2").getValue().longValue());
    assertEquals(3L, inst.getCounters().get("b").get("1").getValue().longValue());
}
