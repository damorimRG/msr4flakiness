public void testUserAlertEventSetting() throws Exception {
    String id = "0000000-000000000000001-oozie-wrkf-C@1";
    SLACalcStatus event = _createSLACalcStatus(id);
    SLARegistrationBean eventBean = event.getSLARegistrationBean();
    // user choose only END MISS, thus, START_MISS email should not be sent
    eventBean.setAlertEvents(EventStatus.END_MISS.name());
    Date startDate = DateUtils.parseDateUTC("2013-01-01T00:00Z");
    Date actualstartDate = DateUtils.parseDateUTC("2013-01-01T01:00Z");
    event.setEventStatus(EventStatus.START_MISS);
    event.setId(id);
    eventBean.setAppName("Test-SLA-Start-Miss");
    eventBean.setUser("dummyuser");
    eventBean.setNominalTime(startDate);
    eventBean.setExpectedStart(startDate);
    eventBean.setAlertContact("alert-receiver@oozie.com");
    event.setActualStart(actualstartDate);
    eventBean.setAppType(AppType.COORDINATOR_ACTION);
    slaEmailListener.onStartMiss(event);
    // START_MISS should not be sent
    MimeMessage[] msgs = greenMail.getReceivedMessages();
    assertEquals(msgs.length, 0);
    // DURATION_MISS should not be sent
    event.setEventStatus(EventStatus.DURATION_MISS);
    slaEmailListener.onDurationMiss(event);
    msgs = greenMail.getReceivedMessages();
    assertEquals(msgs.length, 0);
    // END_MISS should be sent
    event.setEventStatus(EventStatus.END_MISS);
    slaEmailListener.onEndMiss(event);
    msgs = greenMail.getReceivedMessages();
    assertNotNull(msgs[0]);
}
