public void testValidateNameNode() throws Exception {
    HadoopAccessorService has = new HadoopAccessorService();
    Configuration conf = new Configuration(false);
    conf.set("oozie.service.HadoopAccessorService.nameNode.whitelist", " ");
    has.init(conf);
    has.validateNameNode("foo");
    has.validateNameNode("bar");
    has.validateNameNode("blah");
    conf.set("oozie.service.HadoopAccessorService.nameNode.whitelist", "foo,bar");
    has.init(conf);
    has.validateNameNode("foo");
    has.validateNameNode("bar");
    try {
        has.validateNameNode("blah");
        fail("Should have gotten an exception");
    } catch (HadoopAccessorException hae) {
        assertEquals(ErrorCode.E0901, hae.getErrorCode());
        // We have to check for either of these because Java 7 and 8 have a different order
        String s1 = "E0901: NameNode [blah] not allowed, not in Oozie's whitelist. Allowed values are: [foo, bar]";
        String s2 = "E0901: NameNode [blah] not allowed, not in Oozie's whitelist. Allowed values are: [bar, foo]";
        assertTrue("expected:<" + s1 + "> or <" + s2 + "> but was:<" + hae.getMessage() + ">", s1.equals(hae.getMessage()) || s2.equals(hae.getMessage()));
    }
    has.destroy();
}
