 1. Create and populate index
addTime
before
/oak:index/foo
release
getRecheckIntervalMillis
bar
hook
getAccessCount
assertNotNull
TimeUnit
corruptIndex
 And this index would not be considered bad
getInfo
reindex
indexed
getBadIndexTracker
indexNode
processCommit
contains
setProperty
setTicker
 Now index access must be attempted again
 2. Corrupt the index
 As diffAndUpdate would fail and existing LuceneIndexNode would not be changed
foo
assertFalse
update
badIdxInfo
getBadPersistedIndexPaths
badIndexAccess
 7. Now indexNode should be accessible
assertTrue
builder
tracker
after
CommitInfo
acquireIndexNode
getIndexPaths
 Index must be corrupted hence it must be null
ticker
 as update would have failed so old copy would be used
isEmpty
 5. Move clock forward
assertEquals
createIndex
getNodeState
 6. Now lets reindex to fix the corruption
assertNull
 Try to access again
getFailedAccessCount
