getAllSecrets
seed
 Now use a ZKSignerSecretProvider with the newer length
oldSecretProvider
System
getBytes
assertArrayEquals
rand
Assert
 This test verifies that the upgrade goes smoothly.
 Use the same seed and a "plain" Random so we can predict the RNG
currentSecret
 Initialize the znode data with the old secret length
getDummyServletContext
/secret
init
ZKSignerSecretProvider
 to init
getConnectString
forName
zkServer
newSecretProvider
UTF-8
rolloverFrequency
secret6
getCurrentSecret
Charset
secret7
destroy
secret4
assertEquals
secret5
nextLong
secret2
secret3
secret1
assertNull
currentTimeMillis
setProperty
Long
realRollSecret
testUpgradeChangeSecretLength
toString
allSecrets
generateNewSecret
spy
config
